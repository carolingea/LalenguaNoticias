!function(){tinymce.PluginManager.add("focuswp_edit",function(e,t){function o(t){e.windowManager.open({title:focuswp_localized.title,width:jQuery(window).width()-100,height:jQuery(window).height()-100,url:focuswp_localized.url,buttons:!1},{scdata:t})}function n(t){var o;"DIV"===t.nodeName&&e.dom.hasClass(t,"mceTemp")?o=t:"SPAN"!==t.nodeName&&"DT"!==t.nodeName&&"A"!==t.nodeName||(o=e.dom.getParent(t,"div.mceTemp")),o?(o.nextSibling?e.selection.select(o.nextSibling):o.previousSibling?e.selection.select(o.previousSibling):e.selection.select(o.parentNode),e.selection.collapse(!0),e.nodeChanged(),e.dom.remove(o)):e.dom.remove(t),s()}function a(t){var o,n,a,d,l=e.dom;s(),t&&"SPAN"===t.nodeName&&!c(t)&&(l.setAttrib(t,"data-wp-focuswpselect",1),o=l.getRect(t),n='<div class="dashicons dashicons-edit edit" data-mce-bogus="1"></div><div class="dashicons dashicons-no remove" data-mce-bogus="1"></div>',a=l.create("div",{id:"focuswp-toolbar",class:"focuswp-toolbar-grp","data-mce-bogus":"1",style:"position: absolute;",contenteditable:!1},n),d=e.rtl?o.x+o.w-82:o.x,e.getBody().appendChild(a),l.setStyles(a,{top:o.y,left:d}),i=!0)}function c(t){var o=e.dom;return!(!o.getAttrib(t,"data-mce-placeholder")&&!o.getAttrib(t,"data-mce-object"))}function s(){var t=e.dom.get("focuswp-toolbar");t&&e.dom.remove(t),e.dom.setAttrib(e.dom.select("span[data-wp-focuswpselect]"),"data-wp-focuswpselect",null),i=!1}var i=!1;e.addButton("focuswp_edit",{text:!1,icon:"icon dashicons-chart-area",classes:"focuswp-mce-btn-icon",onclick:function(){e.windowManager.open({title:focuswp_localized.title,width:jQuery(window).width()-100,height:jQuery(window).height()-100,url:focuswp_localized.url,buttons:!1})}}),e.on("mousedown",function(t){e.dom.getParent(t.target,"#focuswp-toolbar")?tinymce.Env.ie&&t.preventDefault():"SPAN"!==t.target.nodeName&&s()}),e.on("mouseup",function(t){var i,d=t.target,l=e.dom;t.button&&t.button>1||("DIV"===d.nodeName&&l.getParent(d,"#focuswp-toolbar")?(i=l.select("span[data-wp-focuswpselect]")[0],i&&(e.selection.select(i),l.hasClass(d,"remove")?n(i):l.hasClass(d,"edit")&&o(i))):"SPAN"!==d.nodeName||e.dom.getAttrib(d,"data-wp-focuswpselect")||c(d)?"SPAN"!==d.nodeName&&s():a(d))}),e.on("cut",function(){s()}),e.on("PostProcess",function(e){e.get&&(e.content=e.content.replace(/ data-wp-focuswpselect="1"/g,""))})})}();